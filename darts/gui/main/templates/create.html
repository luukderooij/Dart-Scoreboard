{% include 'header.html' %}

<!-- Main  -->
<main id="main">

<section>
    <div class="container-xxl">
        <h1 class="fs-1 text-center text-bold">Toernooi</h1>
        <h5 class="text-center text-regular">Maak hier een toernooi!</h5>
    </div>
</section>




<section> 
    <div class="container-xxl">
        <div class="mb-3">
            <label for="exampleFormControlInput1" class="form-label">Email address</label>
            <input type="email" class="form-control" id="exampleFormControlInput1" placeholder="name@example.com">
        </div>

        <div class="col-md-6">
            <label for="inputCity" class="form-label">City</label>
            <input type="text" class="form-control" id="inputCity">
          </div>
    </div>
</section>






<section>
    <div class="container-xxl">
        <div id="players_table"></div>
    </div>
</section>



</main>

{% include 'footer.html' %}

<script>
    players()

    function players() {
    let data = { "type": "players" };
    let url = '/api/get/players';

    let response = post(url, data).then(response => {

        var customMutatorDateJoined = function (value, data, type, params, component) {
            let currentDate = new Date(data.date_joined);
            let date = currentDate.getDate();
            let month = currentDate.getMonth() + 1;
            let year = currentDate.getFullYear();
            let dateMonthYear = date + "/" + month + "/" + year;
            return dateMonthYear
        }

        var customMutatorDateUpdated = function (value, data, type, params, component) {
            let currentDate = new Date(data.date_updated);
            console.log(currentDate);
            let minutes = currentDate.getMinutes();
            let hours = currentDate.getHours();
            let date = currentDate.getDate();
            let month = currentDate.getMonth() + 1;
            let year = currentDate.getFullYear();
            let dateMonthYearTime = date + "/" + month + "/" + year + " " + hours + ":" + minutes;
            return dateMonthYearTime
        }

        var players_table = new Tabulator("#players_table", {
            data: response, //set initial table data
            // layout: "fitDataStretch",
            layout: "fitColumns",
            resizableColumnFit: true,
            selectable: 1,


            columns: [
                { title: "#", field: "id", resizable: true, visible: false },
                { title: "VOORNAAM", field: "firstname", resizable: true },
                { title: "ACHTERNAAM", field: "lastname", resizable: true },
                { title: "BIJNAAM", field: "nickname", resizable: true },
                { title: "DATUM TOEGEVOEGD", field: "date_joined", resizable: true, mutator: customMutatorDateJoined },
                { title: "DATUM GEUPDATE", field: "date_updated", resizable: true, mutator: customMutatorDateUpdated }
            ]
        });

        players_table.on("rowSelected", function (row) {
            var selectedData = players_table.getSelectedData();

            document.getElementById("removeButton").value = selectedData[0].id;
            document.getElementById("Formid").value = selectedData[0].id;
            document.getElementById("FormFirstname").value = selectedData[0].firstname;
            document.getElementById("FormLastname").value = selectedData[0].lastname;
            document.getElementById("FormNickname").value = selectedData[0].nickname;
            var myModal = new bootstrap.Modal(document.getElementById('editPlayerModal'))
            myModal.show()

        });
    });
}

function addPlayer() {
    var myModal = new bootstrap.Modal(document.getElementById('addPlayerModal'))
    myModal.show()
}

function removePlayer(playerId) {
    if (confirm('Weet je het zeker dat je deze speler wil verwijderen.')) {
        let data = { playerid: playerId };
        let url = '/api/remove/player';

        post(url, data)
        window.location.reload();

    } else {
        // Do nothing!
        console.log('Player not removed.');
    }
}



</script>